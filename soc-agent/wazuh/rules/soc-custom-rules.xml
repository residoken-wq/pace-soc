<!--
  SOC Custom Security Rules for Wazuh (Simplified)
  Copy to: /var/ossec/etc/rules/soc-custom-rules.xml
  Then: systemctl restart wazuh-manager
-->

<group name="soc,custom,">

    <!-- SSH Brute-force Detection -->
    <rule id="100300" level="10">
        <if_sid>5716</if_sid>
        <description>SOC: SSH authentication failed - possible brute-force</description>
        <group>soc_brute_force,</group>
    </rule>

    <!-- Root Login Alert -->
    <rule id="100401" level="12">
        <if_sid>5501</if_sid>
        <user>root</user>
        <description>SOC: Direct root login detected</description>
        <group>soc_abnormal_login,</group>
    </rule>

    <!-- Critical File Modified -->
    <rule id="100500" level="12">
        <if_group>syscheck</if_group>
        <match>/etc/passwd</match>
        <description>SOC: Critical file /etc/passwd modified</description>
        <group>soc_file_integrity,</group>
    </rule>

    <rule id="100501" level="12">
        <if_group>syscheck</if_group>
        <match>/etc/shadow</match>
        <description>SOC: Critical file /etc/shadow modified</description>
        <group>soc_file_integrity,</group>
    </rule>

    <rule id="100502" level="12">
        <if_group>syscheck</if_group>
        <match>/etc/sudoers</match>
        <description>SOC: Sudoers file modified</description>
        <group>soc_privilege_escalation,</group>
    </rule>

</group>
